{% if site.navigation_header %}
<nav class="nav  nav--header">
  <ul class="list  list--nav">
    {% for item in site.navigation_header %}

      {% if item.url contains '://' %}
        {% assign url = item.url %}
      {% else %}
        {% assign url = item.url | relative_url %}
      {% endif %}

      <li class="item  item--nav{% if item.url == page.url %}  item--current{% endif %}">
        <a href="{{ url }}">{{ item.title }}</a>
      </li>
    {% endfor %}
  </ul>
</nav>
{% else %}
  {% include nav-default.html %}
{% endif %}

<button class="button theme-button" aria-label="Toggle color theme" title="Toggle theme">
  <span class="material-symbols-outlined" aria-hidden="true">light_mode</span>
</button>

<!-- logo is included from site-header to avoid duplication and layout issues -->

<script type="text/javascript">
  // Theme toggle: simple, reliable, and persistent
  (function() {
    const themeButton = document.querySelector('.theme-button');
    if (!themeButton) return;

    const mq = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)');
    const stored = localStorage.getItem('theme');
    const getPreferred = () => stored || (mq && mq.matches ? 'dark' : 'light');

    let current = getPreferred();
    document.documentElement.setAttribute('data-theme', current);

    const icons = { light: 'light_mode', dark: 'dark_mode' };
    function render() {
      // Show the icon that will switch to the opposite theme (clear affordance)
      themeButton.innerHTML = '<span class="material-symbols-outlined" aria-hidden="true">' + (current === 'light' ? icons.dark : icons.light) + '</span>';
      themeButton.setAttribute('aria-pressed', current === 'dark');
      themeButton.setAttribute('title', current === 'light' ? 'Switch to dark theme' : 'Switch to light theme');
    }

    render();
    themeButton.style.display = '';

    themeButton.addEventListener('click', () => {
      current = (document.documentElement.getAttribute('data-theme') === 'light') ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', current);
      localStorage.setItem('theme', current);
      render();
    });

    // If user has no explicit stored preference, respond to OS changes
    if (mq && !stored) {
      mq.addEventListener('change', (e) => {
        current = e.matches ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', current);
        render();
      });
    }
  })();
</script>